<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Open App Test</title>
	<style type="text/css">
		#open-app {
			display: block;
			margin : 100px auto;
			width: 100px;
			height: 40px;
		}
	</style>
</head>
<body>
	<button id="open-app">打开App</button>

	<script type="text/javascript">
		window.onload = function() {
			var button = document.getElementById("open-app")
			button.addEventListener("click", function(event) {

			var u = navigator.userAgent, app = navigator.appVersion; 
			var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器 
			var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
				// openApp("http://www.baidu.com", "scheme://host/iBuick", null, null)
				// var ifr = document.createElement('iframe');
				// ifr.src = 'scheme://host/iBuick';
				// ifr.style.display = 'none';
				// document.body.appendChild(ifr);
				// var openTime = +new Date();
				// window.setTimeout(function(){
				//     document.body.removeChild(ifr);
				//     if( (+new Date()) - openTime < 1500 ){
				//         window.location = 'http://sj.qq.com/myapp/detail.htm?apkName=com.buick';
				//     }
				// },1000)
				if (isAndroid)
				{
					openAndroidApp("scheme://host/iBuick", function(opened) {
						if (opened === 0)
						{
							window.location = 'http://sj.qq.com/myapp/detail.htm?apkName=com.buick';
						}
					})
				}
				<!--if (isAndroid)-->
				<!--{-->
					<!--openAndroidApp("sgmcadossp://cadi", function(opened) {-->
						<!--if (opened === 0)-->
						<!--{-->
							<!--window.location = 'http://sj.qq.com/myapp/detail.htm?apkName=com.buick';-->
						<!--}-->
					<!--})-->
				<!--}-->
				else if (isiOS)
				{
					openIOSApp("ibuick://")
				}
			})

			function openAndroidApp(openUrl, callback) {
			    function checkOpen(cb){
			        var _clickTime = +(new Date());
			        function check(elsTime) {
			            if ( elsTime > 3000 || document.hidden || document.webkitHidden) {
			                cb(1);
			            } else {
			                cb(0);
			            }
			        }

			        var _count = 0, intHandle;
			        intHandle = setInterval(function(){
			            _count++;        
			            var elsTime = +(new Date()) - _clickTime;
			            if (_count>=100 || elsTime > 3000 ) {
			                clearInterval(intHandle);
			                check(elsTime);
			            }
			        }, 20);
			    }

			    var ifr = document.createElement('iframe');
			    ifr.src = openUrl;
			    ifr.style.display = 'none';
			    if (callback) {
			        checkOpen(function(opened){
			            callback && callback(opened);
			        });
			    }
			    
			    document.body.appendChild(ifr);      
			    setTimeout(function() {
			        document.body.removeChild(ifr);
			    }, 2000);  
			}

			function openIOSApp(openUrl) {
				location.href = openUrl;
			    setTimeout(function() {
			        location.href = 'https://itunes.apple.com/cn/app/ibuick/id550070842?mt=8';
			    }, 250);
			    setTimeout(function() {
			        location.reload();
			    }, 1000);
			}
		}
	</script>
</body>
</html>